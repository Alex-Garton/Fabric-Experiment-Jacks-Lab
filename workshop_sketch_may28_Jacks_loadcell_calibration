#include "HX711.h"

const int LOADCELL_DOUT_PIN = 2;
const int LOADCELL_SCK_PIN = 3;
const int buttonPin = 12;
const int switchPin = 13;

HX711 scale; 


void setup() {
 Serial.begin(9600);
 scale.begin(LOADCELL_DOUT_PIN, LOADCELL_SCK_PIN);
 pinMode(buttonPin, INPUT);
 pinMode(switchPin, INPUT);
}

void loop() {
  
  while (digitalRead(switchPin) == 0) {}
  
  if (scale.is_ready()){
    scale.set_scale();
    Serial.println("Press button to tare... remove any weights from the scale.");
    
    while (digitalRead(buttonPin) == 0) {}  //holds here until button is pressed
   
    scale.tare();
    Serial.println("Tare done...");
    delay(300);


    Serial.println("Place a known weight on the scale...");
    delay(1000);
    Serial.println("Enter weight value: ");

    Serial.flush();
    while (Serial.available() == 0) {}
    float weight = Serial.parseFloat();
    Serial.print("Weight: ");
    Serial.print(weight);
    Serial.println(" g");
    
    Serial.println("Press button to obtain reading...");
    

    while (digitalRead(buttonPin) == 0) {}

    if (digitalRead(buttonPin) == 1) {

    long reading = scale.get_units(10);
    Serial.print("Reading: ");
    Serial.println(reading);
    }
    
  }
   

  else {
    Serial.println("HX711 not found.");
  }
  delay(1000);
}

//calibration factor will be the (reading)/(known weight)
